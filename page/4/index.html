<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="计算机 比特币 互联网金融 IFWallet" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="区块链爱好者，互联网从业者">
<meta name="keywords" content="bibodeng, blockchain, bitcoin, bitcoin cash, life, programmer">
<meta property="og:type" content="website">
<meta property="og:title" content="bibodeng">
<meta property="og:url" content="https://bibodeng.github.io/page/4/index.html">
<meta property="og:site_name" content="bibodeng">
<meta property="og:description" content="区块链爱好者，互联网从业者">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="bibodeng">
<meta name="twitter:description" content="区块链爱好者，互联网从业者">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> bibodeng </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">bibodeng</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Think By My Mind</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/09/让正确的事情持续发生/" itemprop="url">
                  让正确的事情持续发生
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-09T12:38:13+08:00" content="2016-01-09">
              2016-01-09
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2016/01/09/让正确的事情持续发生/" class="leancloud_visitors" data-flag-title="让正确的事情持续发生">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;">去年，完成了几件大事，从小到大以来，我所梦想的都能成真，并被幸运女神所眷顾，得到亲友匡助，从而逢凶化吉，柳暗花明。<span style="line-height:1.6;">让正确的事情持续发生，是产品经理的最高境界，也是作为一个独立的人，能够让自己的生活运行在正轨上所应该具备的能力。</span></p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;">在我的周围，总是有一些非常出色的人，他们总是能够把事情做成，我在探寻着，究竟他们具备怎样的一种品质，能够让正确的事情持续发生？经过我的观察，他们大多和我们常人差不多，但是他们心态非常阳光，有明确的追求，关注事情的过程，关注人的感受，永远精力充沛，充满干劲，懂得自我建设。我确信这些品质也必定是来源于他们背后的生活细节。</p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;">随着成长，也带来许多的烦恼，责任更大了，压力也更大了，身体不如从前了，心态也不如以前张牙舞爪的青春时晴天居多。但这些都不是做不到的借口，是应当接受生活本来的模样，它有令你烦恼的一面，也有令你兴奋欢呼的一面，如一年四季，如阴晴风雨。但是，你也拥有了更多能量，更加成熟的思维，更加雄厚的财力，足以让正确的事情持续发生。这种能力来自于处理自己和自己的关系——自持（独自一个人待着，都能好好地），需要你能够控制自己，又能启发自己。我们常常不知道为什么而过得很幸福，但是我们却明确知道为什么而失败。暴怒容易伤身败事，而平和能够让人从容应对；怠惰容易百事废弛，发奋却能够积少成多；短视容易莽撞唐突，远虑能够未雨绸缪；胆怯容易变得庸碌，激情却能够让人竭尽全力，无怨无悔！</p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;">其实那些有益的事物，得来会很艰辛，细嚼却甘甜，如米饭，而非麻辣烫，虽然酸爽不已，却又伤害身体。来得太快，又易让人容持不了，不懂珍惜，口味太重，后面吃什么都不香了。而让正确的事情持续发生，正是要注重过程，把握行事的习惯，让一个原动力持续驱动你的生活朝更好的方向前进，时间到了自然有所收获。而且，劳作是必要的，这样才能受之而不愧。<span style="line-height:1.6;">这个世界，是不确定的，不可知的，但是在稳定的社会中，我们人生的轨迹的近处三五年，却是可见的，将大的梦想划分成小的目标，逐个击破，坚持下去，在机遇来临时，一把抓住，梦想也就不远了。</span></p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;"></p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;">今年的主题是：让正确的事情持续发生！</p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;"></p>
<p style="font-family:'Helvetica Neue';font-size:15px;margin-top:0.667rem;margin-bottom:0.667rem;line-height:24px;widows:auto;">by bibodeng 2016-01-09</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/01/日志/" itemprop="url">
                  日志
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-01T22:23:53+08:00" content="2015-12-01">
              2015-12-01
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/12/01/日志/" class="leancloud_visitors" data-flag-title="日志">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
hello


<script type="text/javascript">

    //调用微信JS api 支付
    function jsApiCall()
    {
        console.log("调用jsApiCall");
        WeixinJSBridge.invoke(
        'getBrandWCPayRequest', 
         {"appId":"wx17e0127ade376e4b","nonceStr":"134b8d88fa0e42f7af61ca74ae86faee","package":"prepay_id=wx201512012227474c14baf3140115438192","paySign":"61D5BD62F4DCA71381B5EC5DF7648544","signType":"MD5","timeStamp":"1448980067"},//josn串
         function (res)
         {
             WeixinJSBridge.log(res.err_msg);
             alert(res.err_code + res.err_desc + res.err_msg);
         }
         );
    }

    function callpay()
    {
        console.log("调用callpay");
        if (typeof WeixinJSBridge == "undefined")
        {
            if (document.addEventListener)
            {
                document.addEventListener('WeixinJSBridgeReady', jsApiCall, false);
            }
            else if (document.attachEvent)
            {
                document.attachEvent('WeixinJSBridgeReady', jsApiCall);
                document.attachEvent('onWeixinJSBridgeReady', jsApiCall);
            }
        }
        else
        {
            jsApiCall();
        }
    }

</script>
<a href="javascript: void(0);" onclick="callpay()" target="_blank" rel="noopener"> pay </a>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/22/微信支付开发初体验/" itemprop="url">
                  微信支付开发初体验
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-22T23:24:46+08:00" content="2015-11-22">
              2015-11-22
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/11/22/微信支付开发初体验/" class="leancloud_visitors" data-flag-title="微信支付开发初体验">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这段时间由于要进行微信公众号相关的开发，故而接触到了微信支付。老版本的V2公众号微信支付比较难搞，有些东西不够规范。新版本的微信支付统一了接口，文档也比较齐全，全部接入商户平台（pay.weixin.qq.com）。下面简述一下微信公众号现金支付的开发过程。</p>
<p>##申请微信支付<br>首先，你要有个公众号，而且是已经经过认证的，这样才能开通微信支付功能。开通微信支付功能后，你需要有个财付通商户号，将商户号绑定到公众号上。我开发的时候，同事已经帮我申请好了公众号及微信支付商户号，一切仅需要根据API进行开发即可。这里碰到过一个坑，我们怎么都不不知道微信商户号为什么没有权限，还叫微信的同事检查了一下，说要将公众号和商户号绑定，并且要审核通过批准开通的支付方式（JSAPI，NATIVE等）才能进行开发。</p>
<p>##NATIVE支付<br>微信的原生支付，是通过扫码，从微信的应用原生入口，如对话框，或者是二维码中进入。与之相对的是JSAPI支付，是从内嵌的浏览器中发起支付，然后在浏览器中有条件的进行支付。NATIVE的支付开发模式分两种，一种是商户通过微信制定的规则，生成一个商品售卖的信息，返回二维码给用户扫码，用户扫码之后，微信回调商户后台，后台正式下单，微信得到下单后让用户支付该单。第二种是商户平台预先下单，相关支付信息已经提交了微信，用户扫码之后进行支付该单，支付完后微信回调商户结果。二者之间主要的差别在于，用户扫描时临时下单还是商户预先帮用户下单，然后再支付。由于我们设计了一个中间的支付平台，我们自身并不知道商品的信息，这样的业务适合由商户平台下单，然后等待回调的方式，这样比较直观，如果是直接卖东西的商户，可以直接提供商品的二维码，那么直接展示商品二维码的方式会直观点，但两者的效果都是等价的，两种支付方式皆可。</p>
<p>采用模式二，向微信下单，将会得到一个prepay_id，还有支付的二维码链接，得到链接后，商户要将它生成为二维码，生成的方式多种多样，一种是通过将数据提交给第三方的网页接口（一个链接），让他们帮忙生成二维码，然后通过<img>标签嵌入到页面中。另外一种是使用别人已经封装好的库，直接将二维码绘制出来，渲染在页面中。二者各有利弊，前一种能够节省资源，但要求网络条件良好，服务稳定，后一种则在本地生成，比较迅速。用户扫描二维码，进行输密码鉴权后，则扣款，等待回调通知商户平台，一般这个时间不会太久，因为用户的页面也在刷新支付结果，以及时地给用户一个反馈。</p>
<p>##JSAPI支付<br>如果在移动端，应用又部署在移动网页上，那么二维码的方式不太适合，虽然也可以长按识别二维码跳转支付，但是这样的体验很怪。一开始，我很不理解，为什么微信不能像NATIVE支付一样，返回一个链接到微信内嵌的浏览器中，然后直接跳转到该支付地址，进入支付页面。后来转念一想，如果任何网页都能直接弹到支付页面，有可能会造成滥用下单，并导致有人中招支付了。微信需要一个授信的入口，让用户进入支付界面。经过测试，微信在浏览器跳转该支付链接的时候，进入不了输密码的界面，原因就是我这个是浏览器里面没有认证微信身份的操作，而对话和二维码扫描则不同，是微信客户端的原生入口，已经自带了微信用户的身份信息等。JSAPI的支付方式就是一个鉴权并跳转的过程，首先前半部分和NATIVE扫码支付一样，先给微信下单，返回一些下单的基本信息（核心的有prepay_id），后台将这些信息告诉前端，让前端跳转到一个微信鉴权的地址，并带上这些信息和一个跳转地址，鉴权通过后会进入支付界面，支付完成后，微信回调商户后台，同时页面回到商户的页面，刷新本地订单状态，呈现支付结果。这里总共是一个三方的关系，微信客户端（商户前端），商户后台，微信后台，这三者之间的交互，最终会使得支付状态一致，至于微信后台背后的银联等东西，对我们商户开发者是透明的。</p>
<p>JSAPI的方式需要通过js脚本调用微信的接口，这个接口就是原生的入口，这样的设计虽然看起来不一样，但是其实和NATIVE统一了。而且下单和支付的逻辑是一样的，只是具体的鉴权和调起的方式不一样。微信<a href="https://pay.weixin.qq.com/wiki/doc/api/index.html" target="_blank" rel="noopener">商户后台</a>有详细的文档。 此外，JSAPI需要在微信公众号填写授权支付目录，只有制定的目录下面才能调起支付请求，一个大平台肯定会考虑比较多可能的情况，从而做得稳妥一点，他们也可能碰到过一些场景，出过问题，才弄成现在这样的设计。</p>
<p>##小结<br>这其中我们踩过很多坑，很多信息也没有办法从界面上获得搞得浪费了一些时间，最好的状态就是一次申请通过，各种该开的支付权限都开了，并且发现了微信公众号后台的一些bug，这条路并不顺利。而且基于微信，我们设计了一个微信支付和积分支付的混合支付平台，用于腾讯内部的支付场景。这里API的设计和安全方面的保障参考了微信和支付宝的设计，后面将会详细说说。</p>
<p>by bibodeng 2015-11-22</p>
<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 博客底部广告 --><ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-7025791392439198" data-ad-slot="8119980266" data-ad-format="auto"></ins> <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/14/果冻学车记/" itemprop="url">
                  果冻学车记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-14T09:27:32+08:00" content="2015-11-14">
              2015-11-14
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/11/14/果冻学车记/" class="leancloud_visitors" data-flag-title="果冻学车记">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;">这段时间做的一个很刻意的决定就是逼自己学车，倚哥家里已经有车，但是是老婆开，所以表示想学车，我们几个没有驾照的一拍即合，即刻响应，花了几千大洋到科兴科学园楼下的永安顺驾校报名了，外地班贵点，但是拿证会快点。有些同学在学校就已经搞定了，可惜那时候虽然有时间，可惜缺钱报名，也没有那种意识。</p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;">报名若干天后，即要求我们看科目一的题目，准备考试，约摸过了二十多天，便去考科目一了，大家都一次性高分通过。这些题目是靠题海战术攻破的，做的题多了，很多答案就记住了。同时利用我们的常识也能解决一些题目，另一方面经过专项的题目训练，增强了交通方面的常识。如交警的手势，速度，灯光信号等，都有了更深的认识。应当中国的考试，最好的办法便是题海战术。</p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;">顺利通过科一之后，我们便开始去训练场练车，训练场比较混乱，虽然有经理安排好练车的事项，但是具体练车的事宜由教练安排。教练有四个，但是经常是这个教练教一下，那个教练教一下，基本上就是谁有空，或者跟谁约的就到场练车就好了，其中的早起，等待，奔波只有自己知道。一般都是工作日约着去练车的，得七点起床，坐公交车到练车的地方，练个四十分钟便上班去。各个科目相对都比较容易上手，但是考试时的要求不一样，也很容易挂。先用一节课学了打方向盘，识别车上的各种部件。后面学习挂一档，用离合控制一档起步和缓慢行驶。后来练的最多的是倒车入库，包括左倒车入库，右倒车入库两种，其中的技巧在于要在合适的点打死和回正，如右倒车入库，在出库时，后车轮出库水平线，则向右打死，然后等待汽车摆正，再回正方向盘。左边也是同理，出库后，甚至无需回正，打死方向盘原路即可返回，当回到接触车库口时，与库边线平行，回正倒入，难点在于，有时候车与入口夹角大了或小了，距离远了或近了，要做适当调整，直到平行后摆正再倒入。一开始我还担心方向盘不如自行车直观，想不到亲自操作后还是觉得很直观，甚至能够做到精准停车。侧方位停车较为简单，看准几个点，及时回正打死即可，某次去惠州巽寮湾看华家班的汽车表演，可以做到多车同步漂移精准侧方停车。直角转弯，走S线，考的就是对方向盘的掌握程度，觉得多了就少打点，少了就多打点，这都是凭车感，但生活中的道路，比较多就是直角和一些小于九十度的锐角，直角在转弯处车头盖住边线向转弯方向打死，小角度转弯，一般轻微调整即可，稍大的角度，一圈足矣。上坡定点看起来很恐怖，因为要在坡地停车，并重新跑起来，对定点的距离也有要求，定点的办法是，在驶到定点处踩离合踩刹车停车，慢慢松离合到车子蠢蠢欲动，然后慢慢松刹车，车子恢复行使，下坡略微加点刹车。下去完成S弯即完成了考试。挂的人比较多就是在倒车入库和侧方位停车，但调整好反光镜使得视野清楚很重要。考完科目二就轻松一些了。路考可能教练会去安排一些练车活动，给安全员一些报酬，好在大家都比较快掌握安全员的手势，掌握了整个考试的流程，后面的事情就比较顺利了。现在都是电子系统考试，作弊不了，所以得靠自己，这点还算比较公平，科目三还是会有人挂的。<span style="font-size:10.5pt;line-height:1.35;">科目四安全文明驾驶，也是题海战术，如果做的题不够多，还是很危险的，我前面二十题已经把四道做错了，后面三十道最多只能错一道了，每做一道都战战兢兢，扫雷一样，还好，最后刚好总共错了五题，成绩合格，宣誓领证了，总共花了约六十天，练车时间十多个小时，考试请了三天假。</span></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:10.5pt;line-height:1.35;"><br>
</span></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;">驾驶是现代人的一项必备技能，很多美国高中生到大学去之前，会先拿到驾照，这样就可以开车去上大学或者出去游学了，更像是一种可以走出去，成为独立，自由的一个人的意义。而在中国，我们往往大学毕业或工作后去学习驾驶，这样更多是趋向于标志着成为成熟的男人or女人，如果有车，可以营造一个家的涵义更多一点。周末带着另一半去海边，后面安全座椅坐着小朋友（是不是想起了速度与激情还有别克英朗的广告）或者一家人自驾游，轻松到更远的地方。至于未来的驾驶技术，可能更多由计算机技术来改进，特斯拉已经推出了自动驾驶的技术，Google也有汽车自动驾驶的技术。我们人也可以解放出来，享受更加安全便利的交通。当时看《银河护卫队》这部电影的时候，曾想象自己有一艘飞船，可以随意穿梭在茫茫宇宙，这是一种多么爽的感觉，我想驾驶一辆车在公路狂奔，应该就是这种感觉。此外人在学习一项技能的时候，总体的学习时间可能并不会很长，但是这个逐渐领悟的过程非常微妙，这种感觉也让人觉得很充实有趣。</p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;"></p>
<p style="widows:auto;padding:0px;font-family:Arial, Helvetica, sans-serif;font-size:14px;">各位学车愉快，考驾成功！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/03/在工作中想得更多/" itemprop="url">
                  在工作中想得更多
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-03T00:54:17+08:00" content="2015-11-03">
              2015-11-03
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/11/03/在工作中想得更多/" class="leancloud_visitors" data-flag-title="在工作中想得更多">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<section style="box-sizing:border-box;"><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="margin:0.5em 0px;position:static;box-sizing:border-box;"><section class="" style="width:0px;margin-left:60%;border-bottom-width:13px;border-bottom-style:solid;border-bottom-color:#f96e57;border-left-width:13px !important;border-left-style:solid !important;border-left-color:transparent !important;border-right-width:13px !important;border-right-style:solid !important;border-right-color:transparent !important;box-sizing:border-box;"> </section> <section class="" style="margin:0px;height:2.4em;border-radius:1em;box-sizing:border-box;background-color:#f96e57;"> <img style="height:1.6em;vertical-align:top;margin:0.3em 0.5em;box-sizing:border-box;" class="" src="http://statics.xiumi.us/stc/images/templates-assets/parts/701-other/007-hint-top-1-v2-img0.png"> <section style="display:inline-block;width:72%;margin-top:0.6em;line-height:1;text-align:center;white-space:nowrap;overflow:hidden;box-sizing:border-box;"> <section class="" style="display:inline-block;overflow:hidden;font-size:14.4px;color:#ffffff;line-height:1.3;box-sizing:border-box;"><section style="box-sizing:border-box;">点击上方<span style="color:#515c7d;font-size:16px;box-sizing:border-box;">“南苑随笔”</span> 可以订阅哦！</section></section> </section> </section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="margin-top:10px;margin-bottom:10px;position:static;box-sizing:border-box;"><section class="" style="width:100%;box-sizing:border-box;"> <section class="" style="float:left;padding:0px 3px 0px 0px;line-height:1;box-sizing:border-box;"> <section class="Powered-by-XIUMI V5" style="box-sizing:border-box;"><section class="" style="position:static;box-sizing:border-box;"><section class="" style="font-size:44.8px;box-sizing:border-box;"><section style="box-sizing:border-box;">最</section></section></section></section> </section> <section class="" style="box-sizing:border-box;min-height:4.5em !important;"> <section class="Powered-by-XIUMI V5" style="box-sizing:border-box;"><section class="" style="position:static;box-sizing:border-box;"><section class="" style="box-sizing:border-box;"><section style="box-sizing:border-box;">近，我们中心的领导在启动一项针对新人的培训，其中benco打了头阵，给我们分享了一些非常有用的思维模式。</section><section style="box-sizing:border-box;"><br style="box-sizing:border-box;">
</section><section style="box-sizing:border-box;">我们在职场中，稍微有点上进心的，都会想着，怎么将自己的工作做到出色，并得到老板的认可。可能我们听得太多要多想多做，要让老板放心，并且能够制造惊喜，让老板眼前亮点。可是要做到此，谈何容易，自己的本职工作，大多数人能够想到的，就是完成就好了，而背后的业务缘由，痛点之类的，并不清楚，故而不知道完成之后接下来应该做什么。这实在是职场中的一忌，随着工作的日渐熟练，虽然经验是有了，但是却没有什么思维模式，做事方法上的改变，而这两种改变，是最根本的改变。我们不做IT民工，我们要做IT顾问！</section><section style="box-sizing:border-box;"><br style="box-sizing:border-box;">
</section></section></section></section> </section> <section style="clear:both;box-sizing:border-box;"></section> </section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="margin:0.5em 0px;position:static;box-sizing:border-box;"><section class="" style="display:inline-block;border-radius:0.5em;padding:0.3em 0.5em;color:#ffffff;box-shadow:#a5a5a5 0.2em 0.2em 0.1em;box-sizing:border-box;background-color:#f96e57;"><section style="box-sizing:border-box;">两个方向问问题</section></section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="position:static;box-sizing:border-box;"><section class="" style="box-sizing:border-box;"><section style="box-sizing:border-box;">以我们IT部门的程序员来说，我们的客户就是HR，全体员工，我们的工作就是打造出IT系统，目标是为了帮助工作每个员工提供良好的办公系统，以提升工作效率，为公司的业绩保驾护航。但是细到我们日常的工作，可能是做一个员工福利平台，实现一个伯乐简历筛选，这里加一个按钮，那里放一个查询之类的，很具体的东西。怎么从中去理解我们的业务和需求，并使得项目达到目标？有两个方向的问题，让我们多想一点。</section><section style="box-sizing:border-box;"><br style="box-sizing:border-box;">
</section><ol style="box-sizing:border-box;"><li style="box-sizing:border-box;"><section style="box-sizing:border-box;">向上游问为什么</section><section style="box-sizing:border-box;">当我们接到一个业务需求，我们先不忙着实现，而是问清楚我们的客户，ta需要达成什么样的一个目标。比如，最近风哥几个做的伯乐系统，整个系统重构了一遍，客户可能会给很具体的需求，要有简历搜索功能，要能够给人才打标签... 但是这纷繁复杂的需求中，到底哪些才是最紧迫的所在。了解到bbs中，大家经常吐槽伯乐系统烂的不行，面试官处理简历又慢，作为占据公司招聘人才半壁江山的一个业务而言，无疑还有很多改进的空间，另外我们有时候还需要揣摩客户的潜台词，客户要完成人才打标签这种需求（甚至还提到了具体数目），是为了什么，结果客户说不上来，很有可能这些是对方的KPI，或者拍脑袋想出来的需求，还是说真的是用户、老板认为真的需要做的地方。流程为啥慢，向上问，就更能梳理出那些是痛点所在，哪些能够让我们的目标更加靠近一些。伯乐的痛点就是，系统bug多，流程处理慢，那么要处理这两个痛点，首要做的是将各种逻辑重构一遍，解掉各种坑；另外，还要想办法把流程加快，风哥他们搞出来的方案是，将HR招聘经理前置，这样在一天之内，推荐的简历就能够经过初筛，看是合不合适了。我自己也体验了一把，处理的确迅速多了。此外他们还专门监控了上线后的运营情况，PV/UV这些就不用说了，简历推荐量，简历处理率和处理平均时间，这些都是围绕业务核心而定出来的运营目标。</section><section style="box-sizing:border-box;"><br style="box-sizing:border-box;">
</section></li>
<li style="box-sizing:border-box;"><section style="box-sizing:border-box;">向下游问又能怎么样</section><section style="box-sizing:border-box;">除了向上问，我们也能向下问，打了标签又能怎么样？会对检索人才更加方便。可是需求对不上啊，人工流程效率太低，检索再快又能怎么样呢？！如果我们将流程前置呢？又会怎么样呢？流程快了，得到反馈也就快了，用户体验好了，自然会有好口碑。事实证明，对比之前的伯乐，现在的伯乐好了很多，bbs里面也少了很多吐槽。这里也额外说明了一点，我们的产品做得如何，去bbs看看用户的声音，用搜索引擎搜索一下『xx 难用』，你就知道有多少用户在骂你了。小马哥很牛的一点是，经常去各种论坛，博客里面看人家对自家产品的认识，还提给开发的同学，被逮到可就没有那么好看了。IT部门十周年的时候，ls说，以前bbs吐槽最多的是RTX，现在，bbs吐槽最多的是财付通。有点扯远了，我们沿着下游一路问为什么，就能够达到我们想要知道的答案，当提出一种解决办法或者需求的时候，不妨用这种方法去摸清楚，此路到底通不通。</section></li>
</ol>
</section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="margin:0.5em 0px;position:static;box-sizing:border-box;"><section class="" style="display:inline-block;border-radius:0.5em;padding:0.3em 0.5em;color:#ffffff;box-shadow:#a5a5a5 0.2em 0.2em 0.1em;box-sizing:border-box;background-color:#f96e57;"><section style="box-sizing:border-box;">我们的价值体现</section></section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="position:static;box-sizing:border-box;"><section class="" style="box-sizing:border-box;"><section style="box-sizing:border-box;">用户或客户对我们的满意度，有高级的满意度和低级的满意度之分。作为IT支持，如果肯办事，叫做什么需求就做什么需求，那是低级的满意度，而高级的满意度，是综合了我们的专业的判断，提供的一套解决方案，这样会让你的客户非常尊重你，觉得你是一个可以拿主意，可以依赖的伙伴。TEG的理念刚好是『专业，服务，伙伴』，我们的目标应当是成为一个IT顾问，而不仅仅是IT民工。benco举了一个例子，就是腾讯的在线笔试系统，其实是招标采购的，当初为什么不做自研，考虑到自研的成本很高，而且未必能够比第三方的服务商要做得好。此外，我们这样做有一些别的好处，业务上，笔试是独立的，输入学生答案，输出学生的分数，而这些东西可能并没有那么敏感，而我们可以在短期内找到做得比较成熟的系统。我们关键要把关的是系统的稳定性，高并发时的可用性，如果能够达到这两点，那么我们的业务目标就达到了。等顺利支持完校招，目标就算达成了。而且，跟第三方合作，第三方的好处不言而喻。不仅获得大单，而且有腾讯把关对自身系统有所提升，也打响了在业界的口碑，实在是一举多得，何乐而不为呢。这体现的就是一种IT顾问精神，我们找最恰当的解决方案，而不是为了干活而干活。我们的在职场的价值体现，在于专业，在于服务。</section><section style="box-sizing:border-box;"><br style="box-sizing:border-box;">
</section></section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="position:static;box-sizing:border-box;"><section class="" style="box-sizing:border-box;"><section style="box-sizing:border-box;">最后，我们会问为什么有些人总能把事情做好，那是因为他们付出了卓绝的努力，并在工作中做出了出色的思考，故而能够如此卓有成效。而我们一个人的成长，也必定是思维模式和能力的共同成长。</section></section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="margin:0.5em 0px;text-align:center;position:static;box-sizing:border-box;"><section class="" style="border:1px solid #f96e57;box-sizing:border-box;"> <section class="" style="padding:1em;box-sizing:border-box;"> <section class="Powered-by-XIUMI V5" style="box-sizing:border-box;"><section class="" style="margin:1em 0px 0px;position:static;box-sizing:border-box;"><section class="" style="display:inline-block;border-radius:1em;color:#ffffff;font-size:16px;padding:0.5em 0.8em;line-height:1;box-sizing:border-box;background-color:#f96e57;"><section style="box-sizing:border-box;">微信号:南苑随笔</section></section></section></section> </section> </section> <section class="" style="border-style:solid;border-width:0px 1px 1px;border-color:#f96e57;box-sizing:border-box;"> <section class="" style="padding:1em;box-sizing:border-box;"> <section class="Powered-by-XIUMI V5" style="box-sizing:border-box;"><section class="" style="position:static;box-sizing:border-box;"><section class="" style="color:#3e3e3e;box-sizing:border-box;"><section style="box-sizing:border-box;">长按识别二维码关注</section></section></section></section> </section> </section></section></section><section class="Powered-by-XIUMI V5" style="position:static;box-sizing:border-box;"><section class="" style="text-align:center;margin-top:10px;margin-bottom:10px;position:static;box-sizing:border-box;"><img style="max-width:100%;box-sizing:border-box;vertical-align:middle;" class="" src="http://statics.xiumi.us/xmi/ua/2LUu/i/4000268e811a5cacd9c2d614b247edba-sz_39897.jpg"></section></section></section>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/01/TEG编码大赛，Show me the code/" itemprop="url">
                  TEG编码大赛，Show me the code
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-01T18:03:45+08:00" content="2015-11-01">
              2015-11-01
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/11/01/TEG编码大赛，Show me the code/" class="leancloud_visitors" data-flag-title="TEG编码大赛，Show me the code">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#TEG Code大赛</p>
<p>九月份的时候参加了TEG Code编程大赛，在腾讯，TEG素来以专研技术在各BG中而名，故而有时候会比较强调码农做的事情，有时候也搞一些比较有意思的比赛，具有浓烈的geek风范。技术从来都是疯狂的程序员所热衷所在，否则就不会走上计算机编程这条不归之路。我们两个鲜肉，联合了两个T3-2的大腿也参加了比赛，干脆就取名叫“大腿鲜肉队”。</p>
<p><img src="http://www.bibodeng.com/content/plugins/kl_album/upload/201511/350685835b307ccc05375c75a0ae3ecf201511011801141163677904.jpg" alt="TEG Code"></p>
<p>初赛的题目是要从一个远程的服务器拉取文件到本地，文件包含家政服务的信息，需要解析并清洗出订单和服务员两种实体，分别存储到数据库的两个表中（也可以不存储），最后按照规则计算如何分配订单和服务员，才能够让收益最大化。下面是具体的题目，由于我们只做了文件传输和解析部分，故而就远程拉取文件和解析给出我们的答案，有机会再将匹配算法给出。</p>
<p>##文件服务端<br>第一步，首先要将服务器端的文件读取到内存中，然后通过网络连接将资料通过TCP协议传送到客户端。根据这个思想，我们用C语言实现了一个单线程的版本，如果要尽量快地发送数据，那就要开多个线程将文件包发送出去。首先计算出文件的大小，然后划分成若干个块，分次读取到内存buffer中，而最后一块比较特殊，因为未必能够填满完整的size内存。读取完后，循环监听TCP请求</p>
<pre><code>//
//  main.c
//  TEG code
//
//  Created by feihongliu on 15/8/22.
//  Copyright (c) 2015年 feihongliu. All rights reserved.
//

////////////////////////////////////
//服务器代码
///////////////////////////////////
//本文件是服务器的代码

#include &lt;netinet in.h=&quot;&quot;&gt;    // for sockaddr_in
#include &lt;sys types.h=&quot;&quot;&gt;     // for socket
#include &lt;sys socket.h=&quot;&quot;&gt;    // for socket
#include &lt;stdio.h&gt;         // for printf
#include &lt;stdlib.h&gt;        // for exit
#include &lt;string.h&gt;        // for bzero
#include &lt;time.h&gt;          //for time_t and time

#define SERVER_PORT 7754
#define LENGTH_OF_LISTEN_QUEUE 20
#define BUFFER_SIZE 1024

#define _FILE_OFFSET_BITS 64
#define MemoryChunk 16777216
#define FILE_PATH &quot;data/1.dat&quot;

int main(int argc, char **argv)
{
    //设置一个socket地址结构server_addr, 代表服务器internet地址, 端口
    struct sockaddr_in server_addr;
    bzero(&amp;amp;server_addr, sizeof(server_addr)); //把一段内存区的内容全部设置为0
    server_addr.sin_family = AF_INET;
    server_addr.sin_addr.s_addr = htons(INADDR_ANY);
    server_addr.sin_port = htons(SERVER_PORT);

    //创建用于internet的流协议(TCP)socket, 用server_socket代表服务器socket
    int server_socket = socket(AF_INET, SOCK_STREAM, 0);
    if (server_socket &amp;lt; 0)
    {
        printf(&quot;Create Socket Failed!&quot;);
        exit(1);
    }

    //把socket和socket地址结构联系起来
    if (bind(server_socket, (struct sockaddr*)&amp;amp;server_addr, sizeof(server_addr)))
    {
        printf(&quot;Server Bind Port : %d Failed!&quot;, SERVER_PORT);
        exit(1);
    }

    //server_socket用于监听
    if (listen(server_socket, LENGTH_OF_LISTEN_QUEUE))
    {
        printf(&quot;Server Listen Failed!&quot;);
        exit(1);
    }

    printf(&quot;Start file read&quot;);
    FILE * pFile;
    long lSize;

    pFile = fopen(FILE_PATH, &quot;rb&quot;);
    fseek(pFile, 0, SEEK_END);
    lSize = ftell(pFile);
    rewind(pFile);

    int mount = lSize / MemoryChunk + 1;
    char ** memaddr_array = (char**)malloc(sizeof(char*)*mount);
    for (int i = 0; i &amp;lt; mount; i++)
    {
        char * buffer;
        buffer = (char*)malloc(sizeof(char)*MemoryChunk);
        memaddr_array[i] = buffer;
    }

    //load file to memery
    for (int i = 0; i &amp;lt; mount - 1; i++)
    {
        fread(memaddr_array[i], MemoryChunk, 1, pFile);
    }
    int last_size = lSize - ftell(pFile);
    fread(memaddr_array[mount - 1], 1, last_size, pFile);

    printf(&quot;End file read&quot;);


    //服务器端要一直运行
    while (1)
    {
        struct sockaddr_in client_addr;
        socklen_t length = sizeof(client_addr);
        int new_server_socket = accept(server_socket, (struct sockaddr*)&amp;amp;client_addr, &amp;amp;length);
        if (new_server_socket &amp;lt; 0)
        {
            printf(&quot;Server Accept Failed!\n&quot;);
            break;
        }
        //首次发送文件大小
        char filelength[64];
        sprintf(filelength, &quot;%ld&quot;, lSize);
        send(new_server_socket, filelength, 64, 0);
        //发送文件内容
        for (int i = 0; i &amp;lt; mount - 1; i++)
        {
            send(new_server_socket, memaddr_array[i], MemoryChunk, 0);
        }
        send(new_server_socket, memaddr_array[mount - 1], last_size, 0);

        //关闭与客户端的连接
        close(new_server_socket);
    }

    //释放资源 关闭监听用的socket
    close(server_socket);
    fclose(pFile);
    for (int i = 0; i &amp;lt; mount; i++)
    {
        free(memaddr_array[i]);
    }
    free(memaddr_array);
    return 0;
}
</code></pre><p>如上所示，最初版本的读取文件和发送都是串行的，后面将会继续优化。</p>
<p>##文件读取客户端</p>
<p>有了服务端，那么我们就要想办法连接TCP，然后将收到的信息存到文件中去。其处理次序与发送相逆，当recv到数据后，append到文件中去，然后对数据进行逐条解析。</p>
<pre><code>//客户端代码

//本文件是客户机的代码
#include &lt;netinet in.h=&quot;&quot;&gt;    // for sockaddr_in
#include &lt;sys types.h=&quot;&quot;&gt;    // for socket
#include &lt;sys socket.h=&quot;&quot;&gt;    // for socket
#include &lt;stdio.h&gt;        // for printf
#include &lt;stdlib.h&gt;        // for exit
#include &lt;string.h&gt;        // for bzero
#include &lt;time.h&gt;                //for time_t and time
#include &lt;arpa inet.h=&quot;&quot;&gt;

#define SERVER_PORT    7754         // server port
#define BUFFER_SIZE 1024            // write to file buffer

#define FILE_OFFSET_BITS 64         // filesize string offset
#define MEMORY_CHUNK_SIZE 16777216  // 16MB
#define DEFAULT_SERVER_IP &quot;127.0.0.1&quot;
#define FILE_PATH  &quot;data/1.client.dat&quot;

// 钟点工
struct Worker{
    int _id;
    char _gender;
    char _age;
    float _score;
};

// 订单
struct Bill{
    int _id;
    double _px;
    double _py;
    char _time;
    char _time_require;
    int _begin_time;
    char* _image;

};



// download module
 // by bibo 2015-08-25
void download_file(char* server_ip, int port)
{
    time_t start, end;
    time(&amp;amp;start);

    FILE *stream;

    //设置一个socket地址结构client_addr,代表客户机internet地址, 端口
    struct sockaddr_in client_addr;
    bzero(&amp;amp;client_addr, sizeof(client_addr)); //把一段内存区的内容全部设置为0
    client_addr.sin_family = AF_INET;    //internet协议族
    client_addr.sin_addr.s_addr = htons(INADDR_ANY);//INADDR_ANY表示自动获取本机地址
    client_addr.sin_port = htons(0);    //0表示让系统自动分配一个空闲端口

    //创建用于internet的流协议(TCP)socket,用client_socket代表客户机socket
    int client_socket = socket(AF_INET, SOCK_STREAM, 0);
    if( client_socket &amp;lt; 0) {
        printf(&quot;Create Socket Failed!\n&quot;);
        exit(1);
    }
    //把客户机的socket和客户机的socket地址结构联系起来
    if( bind(client_socket, (struct sockaddr*)&amp;amp;client_addr, sizeof(client_addr))) {
        printf(&quot;Client Bind Port Failed!\n&quot;);
        exit(1);
    }

    //设置一个socket地址结构server_addr,代表服务器的internet地址, 端口
    struct sockaddr_in server_addr;
    bzero(&amp;amp;server_addr, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    //服务器的IP地址来自程序的参数
    if(inet_aton(server_ip, &amp;amp;server_addr.sin_addr) == 0) {
        printf(&quot;Server IP Address Error!\n&quot;);
        exit(1);
    }

    server_addr.sin_port = htons(port);
    socklen_t server_addr_length = sizeof(server_addr);

    //向服务器发起连接, 连接成功后client_socket代表了客户机和服务器的一个socket连接
    if (connect(client_socket, (struct sockaddr*)&amp;amp;server_addr, server_addr_length) &amp;lt; 0) {
        printf(&quot;Can Not Connect To %s!\n&quot;, server_ip);
        exit(1);
    }

    char buffer[BUFFER_SIZE];
    bzero(buffer, BUFFER_SIZE);

    //从服务器接收数据到buffer中
    int length = recv(client_socket, buffer, BUFFER_SIZE, 0);

    if(length &amp;lt; 0) {
        printf(&quot;Recieve Data From Server %s Failed!\n&quot;, server_ip);
        exit(1);
    }

    // 先接收长度
    long lSize;
    lSize = sscanf(buffer,&quot;%ld&quot;, &amp;amp;lSize); // char array to long

    printf(&quot;\n%s\n&quot;, buffer);
    bzero(buffer, BUFFER_SIZE);

    // open or create file
    if ((stream = fopen(&quot;data&quot;,&quot;wb+&quot;)) == NULL) {
        printf(&quot;The file &apos;data&apos; was not opened! \n&quot;);
    }
    else
    {
        bzero(buffer, BUFFER_SIZE);
    }

    length = 0;
    // 后续是否使用多线程 TODO
    while (length = recv(client_socket, buffer, BUFFER_SIZE, 0)) {
        if (length &amp;lt; 0) {
            printf(&quot;Recieve Data From Server %s Failed!\n&quot;, server_ip);
            break;
        }

        int write_length = fwrite(buffer, sizeof(char), length, stream);
        if (write_length &amp;lt; length) {
            printf(&quot;File is Write Failed\n&quot;);
            break;
        }

        printf(&quot;write data to file!\n&quot;);

        bzero(buffer, BUFFER_SIZE);
    }
    printf(&quot;Recieve File From Server[%s] Finished\n&quot;, server_ip);

    fclose(stream);
    close(client_socket);

    time(&amp;amp;end);
    double t = difftime(end, start);
    printf(&quot;download file use: %f &quot;, t);

}


//解析文件
// by bibo 2015-08-25

void parse_file()
{
    time_t start, end;
    time(&amp;amp;start);

    //--------parse---------

    FILE* stream;
    if ((stream = fopen( FILE_PATH , &quot;rb&quot;)) == NULL)
    {
        printf(&quot;The file &apos;data&apos; was not opened! \n&quot;);
        exit(0);
    }


    // 钟点工 = 长度 + 记录类型（0） + ID + 性别 + 年龄 + 评分
    // 15 字节 = 4 + 1 + 4 + 1 + + 1 + 4

    // 需求 = 长度 + 记录类型 （1）+ ID + 横坐标 + 纵坐标 + 时长 + 时间要求 + 起始时间 + 图片？
    // ? = 4 + 1 + 4 + 8 + 8 + 1 + 1 + 4 + ？


    printf(&quot;int %ld \n&quot;, sizeof(int));
    printf(&quot;short %ld \n&quot;, sizeof(short));
    printf(&quot;float %ld \n&quot;, sizeof(float));
    printf(&quot;long %ld \n&quot;, sizeof(long));
    printf(&quot;char %ld \n&quot;, sizeof(char));

    char buffer[BUFFER_SIZE];
    bzero(buffer, BUFFER_SIZE);


    int record_size = 0;
    long length = 0;

    int bill_num = 0;
    int worker_num = 0;

    // TODO 想办法将结构树体放到某个数据结构中去存储并计算
    // 2G数据，必须要进行分治才能高效计算

    // 读取文件到内存中
    while (length = fread(&amp;amp;record_size, sizeof(int), 1, stream)) {

        // 长度
        // printf(&quot;record size: %d \n&quot;, record_size);
        char type = 0;

        //
        int i = 0;
        char c = 0;
        long l = 0;
        float f = 0;
        double d = 0;


        length = fread(&amp;amp;type, sizeof(char), 1, stream);

        // type
        if (type == 0)
        {
            struct Worker worker;

            fread(&amp;amp;i, sizeof(int), 1, stream); // ID
            worker._id = i;

            fread(&amp;amp;c, sizeof(char), 1, stream); // gender
            worker._gender = c;

            fread(&amp;amp;c, sizeof(char), 1, stream); // age
            worker._age = c;

            fread(&amp;amp;f, sizeof(float), 1, stream); // score
            worker._score = f;

            printf(&quot;get a worker: %d, %d, %d, %f \n&quot;, worker._id, worker._gender, worker._age, worker._score);

            // free(&amp;amp;worker);

            worker_num++;

        }
        else if (type == 1)
        {
            struct Bill bill;

            fread(&amp;amp;i, sizeof(int), 1, stream); // ID
            bill._id = i;

            fread(&amp;amp;d, sizeof(double), 1, stream); // px
            bill._px = d;

            fread(&amp;amp;d, sizeof(double), 1, stream);// py
            bill._py = d;

            fread(&amp;amp;c, sizeof(char), 1, stream); // time
            bill._time = c;

            fread(&amp;amp;c, sizeof(char), 1, stream); // time_require
            bill._time_require = c;

            if (bill._time_require == 1) // 有时间要求
            {
                fread(&amp;amp;i, sizeof(int), 1, stream);
                bill._begin_time = i;

                // 直接略过
                fseek(stream, sizeof(char) * ( record_size - 27 - 4), SEEK_CUR);

                // bill._image = (char*) malloc(sizeof(char) * (record_size - 27 - 4));
                // fread(bill._image, sizeof(char), record_size - 27 - 4, stream);
            }
            else
            {
                bill._begin_time = 0;

                // 直接略过
                fseek(stream, sizeof(char) * ( record_size - 27), SEEK_CUR);

                // bill._image = (char*)malloc(sizeof(char) * (record_size - 27));
                // fread(bill._image, sizeof(char), record_size - 27 , stream);

            }

            printf(&quot;get a bill: %d, %f, %f, %d, %d, %d, %s \n&quot;, bill._id, bill._px, bill._py, bill._time, bill._time_require, bill._begin_time, bill._image);

            // 暂时不存储
            free(bill._image);

            bill_num ++;
        }
    }




    //---------------------
    // show time
    time(&amp;amp;end);
    double t = difftime(end, start);
    printf(&quot;parse file use time: %lf \n&quot;, t);

    printf(&quot;total worker num: %d \n&quot;, worker_num);
    printf(&quot;total bill num: %d \n&quot;, bill_num);

    scanf(&quot;pleas press key to exit: %lf \n &quot;, &amp;amp;t);
    return;
}

// 解析记录
void parse_record()
{
    return;
}

//---------------------Main-----------------------
int main(int argc, char **argv)
{
    if (argc != 2) {
        printf(&quot;Usage: ./%s ServerIPAddress\n&quot;, argv[0]);
        argv[1] = DEFAULT_SERVER_IP;
        // exit(1);
    }


    download_file(argv[1], SERVER_PORT);

    parse_file();

    return 0;
}
</code></pre><p>最终，此次兴趣比赛，因为我们个人没有时间最终没有提交完整的代码。不过，我们最终还是得到了一件文化衫，当时报名也就是为了一件 <code>Talk is cheap , Show me the code</code> 的 T-Shirt，因为于Linux的服务器编程，我们IT部并不在行，而架构平台部，安全平台部比较在行，在决赛的晚会中，他们展示的方案想法其实也差不多，就看谁能够有这么强的代码能力付诸实现。</p>
<p>–end–<br>by biboedeng 2015-11-01&lt;/time.h&gt;&lt;/string.h&gt;&lt;/stdlib.h&gt;&lt;/stdio.h&gt;&lt;/time.h&gt;&lt;/string.h&gt;&lt;/stdlib.h&gt;&lt;/stdio.h&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/10/11/商业头脑的两件小事/" itemprop="url">
                  商业头脑的两件小事
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-10-11T00:07:45+08:00" content="2015-10-11">
              2015-10-11
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/10/11/商业头脑的两件小事/" class="leancloud_visitors" data-flag-title="商业头脑的两件小事">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;">最近听闻我的一个大学舍友要在所在的大城市买房了，感叹同样是毕业一年的学生，怎么赚钱的能力差那么大呢。</p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;"></p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;">我大学毕业以来，进入BAT其中的T工作，而他进入的公司后来被A收购，工资算起来都差不多，但是很要命的是，我们的收入差距居然这么巨大，我到如今所有的积蓄加起来也才那么一点，老家的首付都还远远不够，这令我有点诧异。据我观察，潮汕的同学，有许多都肯动脑筋去想怎么赚钱，而一些专业领域的秘密，正是源源不断的钱的发源地。大学的时候，室友先是开发了一个App挂在未知名的广告平台上供人下载源码，结果收入并不多，一次几毛钱，最终也才累积到十几块钱，后来又开发了一个山寨的flappy bird游戏，虽然使用游戏引擎做起来并不算很复杂，但是借这个势头，在各个广告平台投放广告，赚到了第一桶金，对于尚在学校的我们来说，还算比较客观，而这种轻松的赚钱方法是拼命工作所无法比拟的。可以想见，进入一个游戏广告公司，知道了这种盈利的方式，这就是一种壁垒或者叫商业秘密，一般人不得门而入，但是也不能说是永远无门的，因为只要你开始接触这个领域，做了一款App，接入某个广告平台，你就会越来越深入地窥探到其中的秘密。可以这么说，对于商机，你需要留意并且钻营，一开始可能很小，小到你不以为意，但是当你发现一个大的秘密的时候，赚大钱的机会就来了。</p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;"></p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;">另外一个女同学，刚好也是潮汕人，她自己运营了一个微信公众账号，运用一些营销的手法，如推广公众号，写一些相关文章，竟然使得阅读量能够达到上千，而我久久经营的公众号，因为许久不更新，而订阅量越来越少。我细细一想其中的差别，潮汕的同学的商业头脑，体现在他们能够想办法去把一些与人有关，与钱有关的资源运营和控制起来，从而就把握住了一些商机。而我自己，虽然也在运营，但更多的是出于一种兴趣，想要尝试一下而已，或者说比较清高，只是写自己想写的，没有想着怎么去运用一些营销手段。另外一个我没有做好的地方，是我应当多写一点对别人有益的东西，做到言之有物，而不仅仅是在倾诉着自己的遭遇，于别人有价值，别人才会赋予它价值。</p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;"></p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;">by bibodeng 2015-10-11</p>
<p style="font-family:'Helvetica Neue';font-size:14px;line-height:normal;widows:auto;"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/13/大城小爱/" itemprop="url">
                  大城小爱
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-09-13T00:51:18+08:00" content="2015-09-13">
              2015-09-13
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/09/13/大城小爱/" class="leancloud_visitors" data-flag-title="大城小爱">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
今天，是我和你在一起五个月，很快，我们就要结束异地，相聚在同一个城市了。

做出这个决定，我相信你也是用了很大的勇气，毕竟要来到一个陌生的城市，开始全新的生活。当然想到，能够常常见到，在一个环境很好天空很蓝的城市，一同奋斗，这份小小的爱，在大城里应该会很甜蜜。

当初追求你的时候，我常常跑去广州，但是并不总是能够见到，有时候是你拒绝，有时候是没时间，总算有一次，大家说出来去沙面游玩，才跟着一起去，非常想能见到你，结果那天玩的还算挺开心的，拍了一些照片，获得了好评，当时跟你也踊跃地拍了几张合照，其中一张在门的两边，一张站在窗台上，笑的都挺好的，最后，我鼓起勇气和你合照了一张，并斗胆把手搭在了你的肩上，据说那个举动吓到了你，但总算是有了一个小小的开端。

过了不久，是她的生日，我叫上了她的好闺蜜，策划了一个属于我们江头小伙伴的party，准备party之前，彬彬，雄洲，我们三个先去踩点，终于到了生日那天，我们在维多利广场吃饭，然后到钱柜去唱K。晚饭的时候，都还比较尴尬，小伙伴们也算是借这个机会聚了一下，当天晚上准备了蛋糕，吃完饭出来夜色刚刚好，橘黄色的灯照耀着优衣库下面的小广场，一切是这么地美好，然后就去唱k了，途中，只和你说了几句话，稍微没有那么尴尬了。唱K途中由于紧张，唱得不好，只是好基友们在一起烘托氛围，热情献唱。直到吃过蛋糕，已经很晚了，大家都已经回去，剩下我的几个基友，还有你的好闺蜜钟，表白的过程异常艰辛，我好不容易鼓起勇气，却又不敢看你，不敢和你说话，直到十二点多，才鼓起勇气坐过去，聊了一下，拿出电脑播放我制作的幻灯片，期间几个照片你笑了，然后送上生日礼物—— 一本专属相册，一个QQ公仔，想不到你居然欣然接受。播完视频，气氛再度冷落下来，我没有勇气说出最重要的话，待在一旁踟蹰。最后被钟一脚踢过去了，才鼓起勇气表白了，两个人说了一些悄悄话，最后我问，愿不愿意做我的女朋友，你显得非常紧张，我想去拉你的手，你却把它压在大腿下，最后硬牵了一会，然后你说要好好考虑。这个时候钟不知道对你说了什么，然后你就笑了，当我再次问的时候，就说答应了，这个时候好基友们在唱《今年你要嫁给我》等很欢快的歌，我顺利地牵起了女神的手一起欢唱这最后一首歌，必须给亲爱的小伙伴们点赞。可是，这时候的我，却异常地平静，好友们却激动得不行，仿佛自己恋爱了一般。我知道，我得到了一个好女孩，还有非常好朋友在身边，很幸福。

回去睡了一觉，回到已经非常晚了，我非常平静，好基友们在激动地谈论，或者是感叹就我有女朋友了，他们都还单身哪，这么卖力，是不是要我把袜子，内裤都帮他们洗了。第二天醒来，发现莫名地想念，非常想见到你。于是第二天专门请了一天假，去和心爱的你约会，第一次约会，谈了很多很多，从中午谈到下午，然后依依不舍地分别了，地铁关上门那一刻，都忍不住多看对方两眼。我坐在高铁上，看着窗外的夜景，居然哭了，哭得稀里哗啦的，十年前，我开始喜欢你，中间几经波折，也许久不联系，但是最终，我们真的走在了一起，这一切的想念，委屈，高兴都在这一刻爆发了。



后来，你告诉我，那天晚上你心动了，我们是两情相悦。你还告诉我，我穿着白色衬衫的样子很帅，而我觉得你穿着白色上衣的样子，不可替代。如今看起来，都觉得很不可思议，当时是多么尴尬，而现在却又是那么地甜蜜，一切都是最好的安排。有时候我会有很强的预感，预感到我人生的一些旅程场景，而对于你，异常强烈。每一段爱情故事，都是那么传奇，而在一起之后，过得却是平淡的生活，没有那么传奇，却是实在的开心。祝愿有情人终成眷属。

by bibodeng 2015-09-12

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/07/01/本地安装NuGet包/" itemprop="url">
                  本地安装NuGet包
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-01T10:56:02+08:00" content="2015-07-01">
              2015-07-01
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/07/01/本地安装NuGet包/" class="leancloud_visitors" data-flag-title="本地安装NuGet包">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#本地安装NuGet包</p>
<p>由于内部开发时使用的是开发域的网络，Visual Studio中的包管理器无法通过网络访问NuGet仓库，故而我们需要想办法来通过下载到包，然后手动安装到我们的项目中。</p>
<p>##第一步 下载NuGet包</p>
<p>可以通过NuGet网站 <code>https://www.nuget.org/</code> 来查找要安装的包，记住包名PackageId。</p>
<pre><code>https://www.nuget.org/api/v2/package/{packageId}/{version}
</code></pre><p>以包 <code>Microsoft.AspNet.WebApi</code> 为例，下面通过链接来下载该包的5.2.3版本，在浏览器中输入</p>
<pre><code>https://www.nuget.org/api/v2/package/Microsoft.AspNet.WebApi/5.2.3
</code></pre><p>将下载到的NuGet包拷贝到开发机中的本地硬盘某个位置。</p>
<p>##第二步 安装NuGet包</p>
<p>要安装NuGet包，需要在项目中打开NuGet Manager, 选中项目，右键点击菜单，选中Manage NuGet Package，然后点击 Setting进入到设置界面， 配置添加一个源到Package Source中，待会在安装中即可选择这个本地源了。</p>
<p><img src="http://www.bibodeng.com/content/plugins/kl_album/upload/201507/216964db532c1a9231695eed0bac46c5201507011058361414530903.png" alt="Manage NuGet Package界面"></p>
<p>Manage NuGet Package界面</p>
<p><img src="http://www.bibodeng.com/content/plugins/kl_album/upload/201507/6e85d7818d8da83fd4f6cba85313c94c201507011058361170095749.png" alt="添加本地源"></p>
<p>添加本地源</p>
<p>添加完本地源后，例子中我们添加了一个localNuGet，地址是E盘下的nuget目录。刚刚我们把下载到的NuGet包放在了这里，今后要安装包，从这里选择即可。再次打开Manage NuGet Package界面，即可看到Online菜单下面有我们添加的localNuget源了，从里面可以选中我们要安装的包进行安装。</p>
<p><img src="http://www.bibodeng.com/content/plugins/kl_album/upload/201507/ca3e2db8d762a134508a330ceef67def201507011058361783180342.png" alt="从本地源安装包"></p>
<p>从本地源安装包</p>
<p>##后记<br>在安装一些依赖很多的包的时候，常常出现无法解决依赖的错误，依赖无法满足则包不能被安装成功。所以本地源手动安装包非常麻烦，需要把依赖的包都安装好后，才能安装自己想要安装的那个包，不像联网的时候需要什么包就自动去根据依赖去获取，而且这些包的依赖，各种版本虽然能够对应，但保不齐不出什么问题。所以能够联网安装包尽量联网安装，这样省心省力。</p>
<p>另外，推荐一个Web API文档自动生成的工具swagger，可以通过NuGet安装Swashbuckle来引入，祝开发愉快！</p>
<p>by bibodeng 2015-07-01</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/06/26/RSA算法长文本加密/" itemprop="url">
                  RSA算法长文本加密
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-06-26T16:49:19+08:00" content="2015-06-26">
              2015-06-26
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2015/06/26/RSA算法长文本加密/" class="leancloud_visitors" data-flag-title="RSA算法长文本加密">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;">RSA是最常用的非对称加密算法，公钥用于加密，私钥用来解密。私钥还可以用来签名，公钥可以认证该签名。<span style="font-size:10.5pt;line-height:1.5;">我们可以使用生成的公钥和密钥进行RSA的加密和解密，简单的文本加解密如下，主要思路就是，根据传入的密钥，构造Provider，然后使用Provider执行加解密操作。使用公钥加密完成后，可以转换成Base64编码，也可以保存在Byte[]，响应地解密时需要传入Byte[]类型的密文。</span></div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><br>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string xmlPublicKey : xml 格式的公钥字符串</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string m_strEncryptString: 明文字符串</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPublicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> plainText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPublicKey</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> bytes </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">UnicodeEncoding</span><span class="pun" style="color:#93a1a1;">().</span><span class="typ" style="color:teal;">GetBytes</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Encrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">bytes</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">));</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string xmlPrivateKey ：xml 格式的私钥字符串</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string encryptedText : 解密字符串</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encryptedText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> rgb </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptedText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> bytes </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Decrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">rgb</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">UnicodeEncoding</span><span class="pun" style="color:#93a1a1;">().</span><span class="typ" style="color:teal;">GetString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">bytes</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div>下面用一个例子进行测试：</div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">// RSAUtil类，可以用来模拟生成公钥和私钥</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">class</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// 创建一对公钥私钥</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RsaProvider</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 获取RSA的公钥xml</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAPublicKeyXML</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 返回公钥及私钥xml</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAKeyPairXML</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">true</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 获取RSA的公钥</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAPublicKey</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ExportParameters</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></p>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;"> </span></code></p>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 返回公钥及私钥</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAKeyPair</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ExportParameters</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">true</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">class</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Program</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 测试</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">void</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">TestRSA</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RSAUtil</span><span class="pln" style="color:#48484c;"> rsaUtil </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// 生成一对密钥</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params1 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKey</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params2 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPair</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> publicKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKeyXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> privateKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPairXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// 下面尝试加密解密</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> msg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="str" style="color:#dd1144;">@"hello world"</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">publicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> msg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> decodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">privateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> encodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">Console</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">WriteLine</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">decodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div><br>
</div>
<div>在Main函数中运行该TestRSA()函数，结果为正确helllo world，说明解密成功。然而这样的做法存在问题，当明文长度过长，则以上函数无法使用，因为RSA1024只能加密117个字节以内的数据。<span style="font-size:10.5pt;line-height:1.5;">RSA算法能够对数据进行非对称加密，但是非对称加密的成本是很高的。1024bit的密钥，只能加密1024 / 8 - 11 = 117字节长度的明文，生成的密文长度最大为1024/8=128字节（此外RSA的签名能够生成一个和密钥长度相等的签名，用C#内置的Verify方法可以进行验证）。故而我们需要重写我们的加解密函数，按最大117一组来进行加密，反之，按最大128字节一组来解密。</span></div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><span style="font-size:10.5pt;line-height:1.5;"><br>
</span></div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncryptForLongString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPublicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> plainText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPublicKey</span><span class="pun" style="color:#93a1a1;">);</span></code></p>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;"> </span></code></p>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> plainTextData </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Encoding</span><span class="pun" style="color:#93a1a1;">.</span><span class="pln" style="color:#48484c;">UTF8</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetBytes</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> maxBlockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">KeySize</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">/</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">8</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">-</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">11</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">if</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainTextData</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">&lt;=</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">)</span><span class="pln" style="color:#48484c;">   </span><span class="com" style="color:#93a1a1;">// 长度不满一节</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Encrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainTextData</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">));</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 超长</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> plainStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainTextData</span><span class="pun" style="color:#93a1a1;">))</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> cryptStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">())</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// read from plainStream </span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> buffer </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">maxBlockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">while</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">blockSize </span><span class="pun" style="color:#93a1a1;">&gt;</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 实际读取到的长度</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> toEncrypt </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">blockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 拷贝到toEncrypt</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Array</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Copy</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> toEncrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> blockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 得到加密片段</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> cryptograph </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Encrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">toEncrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 放到输出流中</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Write</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">cryptograph</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> cryptograph</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToArray</span><span class="pun" style="color:#93a1a1;">());</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;">&nbsp;</code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecryptForLongString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encryptText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> encryptTextData </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Console</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">WriteLine</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 每个加密块最大长度</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> maxBlockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">KeySize</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">/</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">8</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 无需分段</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">if</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">&lt;</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Encoding</span><span class="pun" style="color:#93a1a1;">.</span><span class="pln" style="color:#48484c;">UTF8</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Decrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">));</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 需要分段</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> cryptStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">))</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> plainStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">())</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> buffer </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">maxBlockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Position</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">while</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">blockSize </span><span class="pun" style="color:#93a1a1;">&gt;</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> toDecrypt </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">blockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Array</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Copy</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> toDecrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> blockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> plainText </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Decrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">toDecrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Write</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainText</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> plainText</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Encoding</span><span class="pun" style="color:#93a1a1;">.</span><span class="pln" style="color:#48484c;">UTF8</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToArray</span><span class="pun" style="color:#93a1a1;">());</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div>测试运行：</div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">// 测试公钥私钥产生及加密</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">void</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">TestRSA</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSAUtil</span><span class="pln" style="color:#48484c;"> rsaUtil </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 生成一对密钥</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params1 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKey</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params2 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPair</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> publicKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKeyXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> privateKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPairXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 下面尝试加密解密</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> msg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="str" style="color:#dd1144;">@"最近用了近两三天来翻完了《大话设计模式》这本书，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	里面一一展示了29种设计模式，这些设计模式都是基于面向对象的，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	根据各种法则推演出来，是面向对象的“类的结构”.</span></code></div>
<span style="color:#1e347b;"> </span><div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	里面很多结构都是借鉴了生活中的一些解耦的思想，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	我们开发的过程中应当有意识地在编写代码的时候怎么样让程序结构更好。</span></code></div>
<span style="color:#1e347b;"> </span><div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	这其实是用一种面向对象的思想来思考程序的各个模块，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	而我们的世界本来就是各种对象的协作，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	我们是要让程序模拟我们的现实世界"</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 根据上面生成的公钥进行加密</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncryptFromStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">publicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> msg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 根据密钥进行解密</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> decodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecryptFromStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">privateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> encodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Console</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">WriteLine</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">decodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L2" style="line-height:18px;padding-left:0px;list-style-type:none;"><span style="color:#93a1a1;">}</span></div>
</div>
</pre></div>
<div><br>
</div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;">by bibodeng 2015-06-26</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/bitcoin-cash-logo.svg"
               alt="bibodeng" />
          <p class="site-author-name" itemprop="name">bibodeng</p>
          <p class="site-description motion-element" itemprop="description">区块链爱好者，互联网从业者</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">190</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/bibodeng" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/bibodeng" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/bibodeng" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://ifwallet.com" title="IFWallet" target="_blank">IFWallet</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://ifpass.cash" title="IFPassword" target="_blank">IFPassword</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bibodeng</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("RrMSWOa8nuCnCCWn8TyPa7Od-gzGzoHsz", "8xnzit83sqv6vUEuXlsEWe0s");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
