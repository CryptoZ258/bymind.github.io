---
title: RSA算法长文本加密
date: 2015-06-26 16:49:19
---
{% raw %}
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;">RSA是最常用的非对称加密算法，公钥用于加密，私钥用来解密。私钥还可以用来签名，公钥可以认证该签名。<span style="font-size:10.5pt;line-height:1.5;">我们可以使用生成的公钥和密钥进行RSA的加密和解密，简单的文本加解密如下，主要思路就是，根据传入的密钥，构造Provider，然后使用Provider执行加解密操作。使用公钥加密完成后，可以转换成Base64编码，也可以保存在Byte[]，响应地解密时需要传入Byte[]类型的密文。</span></div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><br />
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string xmlPublicKey : xml 格式的公钥字符串</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string m_strEncryptString: 明文字符串</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPublicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> plainText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPublicKey</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> bytes </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">UnicodeEncoding</span><span class="pun" style="color:#93a1a1;">().</span><span class="typ" style="color:teal;">GetBytes</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Encrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">bytes</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">));</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string xmlPrivateKey ：xml 格式的私钥字符串</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">//string encryptedText : 解密字符串</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encryptedText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> rgb </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptedText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> bytes </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Decrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">rgb</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">UnicodeEncoding</span><span class="pun" style="color:#93a1a1;">().</span><span class="typ" style="color:teal;">GetString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">bytes</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div>下面用一个例子进行测试：</div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">// RSAUtil类，可以用来模拟生成公钥和私钥</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">class</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// 创建一对公钥私钥</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RsaProvider</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 获取RSA的公钥xml</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAPublicKeyXML</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 返回公钥及私钥xml</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAKeyPairXML</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">true</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 获取RSA的公钥</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAPublicKey</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ExportParameters</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></p>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;"> </span></code></p>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;summary&gt;</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// 返回公钥及私钥</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;/summary&gt;</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">/// &lt;returns&gt;&lt;/returns&gt;</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">GetRSAKeyPair</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RsaProvider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ExportParameters</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">true</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">class</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Program</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 测试</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">void</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">TestRSA</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RSAUtil</span><span class="pln" style="color:#48484c;"> rsaUtil </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// 生成一对密钥</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params1 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKey</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params2 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPair</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> publicKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKeyXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> privateKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPairXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// 下面尝试加密解密</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> msg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="str" style="color:#dd1144;">@"hello world"</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">publicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> msg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> decodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">privateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> encodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">Console</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">WriteLine</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">decodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div><br />
</div>
<div>在Main函数中运行该TestRSA()函数，结果为正确helllo world，说明解密成功。然而这样的做法存在问题，当明文长度过长，则以上函数无法使用，因为RSA1024只能加密117个字节以内的数据。<span style="font-size:10.5pt;line-height:1.5;">RSA算法能够对数据进行非对称加密，但是非对称加密的成本是很高的。1024bit的密钥，只能加密1024 / 8 - 11 = 117字节长度的明文，生成的密文长度最大为1024/8=128字节（此外RSA的签名能够生成一个和密钥长度相等的签名，用C#内置的Verify方法可以进行验证）。故而我们需要重写我们的加解密函数，按最大117一组来进行加密，反之，按最大128字节一组来解密。</span></div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><span style="font-size:10.5pt;line-height:1.5;"><br />
</span></div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="color:#1e347b;margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncryptForLongString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPublicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> plainText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPublicKey</span><span class="pun" style="color:#93a1a1;">);</span></code></p>
<p style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;"> </span></code></p>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> plainTextData </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Encoding</span><span class="pun" style="color:#93a1a1;">.</span><span class="pln" style="color:#48484c;">UTF8</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetBytes</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> maxBlockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">KeySize</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">/</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">8</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">-</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">11</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">if</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainTextData</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">&lt;=</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">)</span><span class="pln" style="color:#48484c;">   </span><span class="com" style="color:#93a1a1;">// 长度不满一节</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Encrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainTextData</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">));</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 超长</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> plainStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainTextData</span><span class="pun" style="color:#93a1a1;">))</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> cryptStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">())</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="com" style="color:#93a1a1;">// read from plainStream </span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> buffer </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">maxBlockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">while</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">blockSize </span><span class="pun" style="color:#93a1a1;">&gt;</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 实际读取到的长度</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> toEncrypt </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">blockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 拷贝到toEncrypt</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Array</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Copy</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> toEncrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> blockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 得到加密片段</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> cryptograph </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Encrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">toEncrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="com" style="color:#93a1a1;">// 放到输出流中</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Write</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">cryptograph</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> cryptograph</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToArray</span><span class="pun" style="color:#93a1a1;">());</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;">&nbsp;</code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecryptForLongString</span><span class="pun" style="color:#93a1a1;">(</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encryptText</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pln" style="color:#48484c;"> provider </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSACryptoServiceProvider</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromXmlString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">xmlPrivateKey</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> encryptTextData </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Convert</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">FromBase64String</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptText</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Console</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">WriteLine</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 每个加密块最大长度</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> maxBlockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">KeySize</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">/</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">8</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 无需分段</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">if</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">&lt;</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Encoding</span><span class="pun" style="color:#93a1a1;">.</span><span class="pln" style="color:#48484c;">UTF8</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Decrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">));</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 需要分段</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> cryptStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">encryptTextData</span><span class="pun" style="color:#93a1a1;">))</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	using </span><span class="pun" style="color:#93a1a1;">(</span><span class="typ" style="color:teal;">MemoryStream</span><span class="pln" style="color:#48484c;"> plainStream </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">MemoryStream</span><span class="pun" style="color:#93a1a1;">())</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> buffer </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">maxBlockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Position</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="typ" style="color:teal;">int</span><span class="pln" style="color:#48484c;"> blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">while</span><span class="pln" style="color:#48484c;"> </span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">blockSize </span><span class="pun" style="color:#93a1a1;">&gt;</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">)</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> toDecrypt </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[</span><span class="pln" style="color:#48484c;">blockSize</span><span class="pun" style="color:#93a1a1;">];</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Array</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Copy</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> toDecrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> blockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			</span><span class="typ" style="color:teal;">Byte</span><span class="pun" style="color:#93a1a1;">[]</span><span class="pln" style="color:#48484c;"> plainText </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> provider</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Decrypt</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">toDecrypt</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">false</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Write</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainText</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> plainText</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Length</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">			blockSize </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> cryptStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">Read</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">buffer</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> </span><span class="lit" style="color:#195f91;">0</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> maxBlockSize</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">		</span><span class="kwd" style="color:#1e347b;">return</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">Encoding</span><span class="pun" style="color:#93a1a1;">.</span><span class="pln" style="color:#48484c;">UTF8</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetString</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">plainStream</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">ToArray</span><span class="pun" style="color:#93a1a1;">());</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="pun" style="color:#93a1a1;">}</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">}</span></code></div>
</div>
</pre></div>
<div>测试运行：</div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;"><div><pre class="prettyprint linenums prettyprinted" style="font-size:13px;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;background-color:#f7f7f9;padding:10px;border:1px solid #e1e1e8;tab-size:4;box-shadow:#fbfbfc 40px 0px 0px inset, #ececf0 41px 0px 0px inset;"><div class="linenums" style="margin-top:0px;margin-bottom:0px;padding-left:0px;"><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="com" style="color:#93a1a1;">// 测试公钥私钥产生及加密</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="kwd" style="color:#1e347b;">public</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">static</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">void</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">TestRSA</span><span class="pun" style="color:#93a1a1;">()</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pun" style="color:#93a1a1;">{</span></code></div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSAUtil</span><span class="pln" style="color:#48484c;"> rsaUtil </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="kwd" style="color:#1e347b;">new</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAUtil</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 生成一对密钥</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params1 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKey</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">RSAParameters</span><span class="pln" style="color:#48484c;"> params2 </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPair</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> publicKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAPublicKeyXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> privateKey </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> rsaUtil</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">GetRSAKeyPairXML</span><span class="pun" style="color:#93a1a1;">();</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L3" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 下面尝试加密解密</span></code></div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> msg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="str" style="color:#dd1144;">@"最近用了近两三天来翻完了《大话设计模式》这本书，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	里面一一展示了29种设计模式，这些设计模式都是基于面向对象的，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L6" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	根据各种法则推演出来，是面向对象的“类的结构”.</span></code></div>
<span style="color:#1e347b;"> </span><div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	里面很多结构都是借鉴了生活中的一些解耦的思想，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	我们开发的过程中应当有意识地在编写代码的时候怎么样让程序结构更好。</span></code></div>
<span style="color:#1e347b;"> </span><div class="L9" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	这其实是用一种面向对象的思想来思考程序的各个模块，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	而我们的世界本来就是各种对象的协作，</span></code></div>
<span style="color:#1e347b;"> </span><div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="str" style="color:#dd1144;">	我们是要让程序模拟我们的现实世界"</span><span class="pun" style="color:#93a1a1;">;</span></code></div>
<div class="L2" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L4" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 根据上面生成的公钥进行加密</span></code></div>
<div class="L5" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> encodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSAEncryptFromStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">publicKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> msg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L7" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="com" style="color:#93a1a1;">// 根据密钥进行解密</span></code></div>
<div class="L8" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="kwd" style="color:#1e347b;">string</span><span class="pln" style="color:#48484c;"> decodeMsg </span><span class="pun" style="color:#93a1a1;">=</span><span class="pln" style="color:#48484c;"> </span><span class="typ" style="color:teal;">RSADecryptFromStream</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">privateKey</span><span class="pun" style="color:#93a1a1;">,</span><span class="pln" style="color:#48484c;"> encodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L0" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;"><code class="language-cs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;word-wrap:break-word;"><span class="pln" style="color:#48484c;">	</span><span class="typ" style="color:teal;">Console</span><span class="pun" style="color:#93a1a1;">.</span><span class="typ" style="color:teal;">WriteLine</span><span class="pun" style="color:#93a1a1;">(</span><span class="pln" style="color:#48484c;">decodeMsg</span><span class="pun" style="color:#93a1a1;">);</span></code></div>
<div class="L1" style="color:#bebec5;line-height:18px;padding-left:0px;list-style-type:none;">
</div>
<div class="L2" style="line-height:18px;padding-left:0px;list-style-type:none;"><span style="color:#93a1a1;">}</span></div>
</div>
</pre></div>
<div><br />
</div>
</div>
<div style="font-family:微软雅黑, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, 宋体, PMingLiU, serif;font-size:14px;line-height:21px;widows:auto;">by bibodeng 2015-06-26</div>{% endraw %}
